{"ast":null,"code":"import _classCallCheck from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _objectSpread from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _triggerButtonPositio, _triggerButtonPositio2;\n\nimport settings from '../../globals/js/settings';\nimport mixin from '../../globals/js/misc/mixin';\nimport createComponent from '../../globals/js/mixins/create-component';\nimport initComponentBySearch from '../../globals/js/mixins/init-component-by-search';\nimport eventedShowHideState from '../../globals/js/mixins/evented-show-hide-state';\nimport handles from '../../globals/js/mixins/handles';\nimport FloatingMenu, { DIRECTION_TOP, DIRECTION_BOTTOM } from '../floating-menu/floating-menu';\nimport getLaunchingDetails from '../../globals/js/misc/get-launching-details';\nimport on from '../../globals/js/misc/on';\n/**\n * The CSS property names of the arrow keyed by the floating menu direction.\n * @type {Object<string, string>}\n */\n\nvar triggerButtonPositionProps = (_triggerButtonPositio = {}, _defineProperty(_triggerButtonPositio, DIRECTION_TOP, 'bottom'), _defineProperty(_triggerButtonPositio, DIRECTION_BOTTOM, 'top'), _triggerButtonPositio);\n/**\n * Determines how the position of arrow should affect the floating menu position.\n * @type {Object<string, number>}\n */\n\nvar triggerButtonPositionFactors = (_triggerButtonPositio2 = {}, _defineProperty(_triggerButtonPositio2, DIRECTION_TOP, -2), _defineProperty(_triggerButtonPositio2, DIRECTION_BOTTOM, -1), _triggerButtonPositio2);\n/**\n * @param {Element} menuBody The menu body with the menu arrow.\n * @param {string} direction The floating menu direction.\n * @returns {FloatingMenu~offset} The adjustment of the floating menu position, upon the position of the menu arrow.\n * @private\n */\n\nexport var getMenuOffset = function getMenuOffset(menuBody, direction) {\n  var triggerButtonPositionProp = triggerButtonPositionProps[direction];\n  var triggerButtonPositionFactor = triggerButtonPositionFactors[direction];\n\n  if (!triggerButtonPositionProp || !triggerButtonPositionFactor) {\n    console.warn('Wrong floating menu direction:', direction); // eslint-disable-line no-console\n  }\n\n  var menuWidth = menuBody.offsetWidth;\n  var arrowStyle = menuBody.ownerDocument.defaultView.getComputedStyle(menuBody, ':before');\n  var values = [triggerButtonPositionProp, 'left', 'width', 'height', 'border-top-width'].reduce(function (o, name) {\n    return _objectSpread({}, o, _defineProperty({}, name, Number((/^([\\d-.]+)px$/.exec(arrowStyle.getPropertyValue(name)) || [])[1])));\n  }, {});\n\n  if (Object.keys(values).every(function (name) {\n    return !isNaN(values[name]);\n  })) {\n    var left = values.left,\n        width = values.width,\n        height = values.height,\n        borderTopWidth = values['border-top-width'];\n    return {\n      left: menuWidth / 2 - (left + Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2)) / 2),\n      top: Math.sqrt(Math.pow(borderTopWidth, 2) * 2) + triggerButtonPositionFactor * values[triggerButtonPositionProp]\n    };\n  }\n\n  return undefined;\n};\n\nvar OverflowMenu =\n/*#__PURE__*/\nfunction (_mixin) {\n  _inherits(OverflowMenu, _mixin);\n\n  /**\n   * Overflow menu.\n   * @extends CreateComponent\n   * @extends InitComponentBySearch\n   * @extends Handles\n   * @param {HTMLElement} element The element working as a modal dialog.\n   * @param {Object} [options] The component options.\n   * @param {string} [options.selectorOptionMenu] The CSS selector to find the menu.\n   * @param {string} [options.classShown] The CSS class for the shown state, for the trigger UI.\n   * @param {string} [options.classMenuShown] The CSS class for the shown state, for the menu.\n   * @param {string} [options.classMenuFlip] The CSS class for the flipped state of the menu.\n   * @param {Object} [options.objMenuOffset] The offset locating the menu for the non-flipped state.\n   * @param {Object} [options.objMenuOffsetFlip] The offset locating the menu for the flipped state.\n   */\n  function OverflowMenu(element, options) {\n    var _this;\n\n    _classCallCheck(this, OverflowMenu);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OverflowMenu).call(this, element, options));\n\n    _this.manage(on(_this.element.ownerDocument, 'click', function (event) {\n      _this._handleDocumentClick(event);\n\n      _this.wasOpenBeforeClick = undefined;\n    }));\n\n    _this.manage(on(_this.element.ownerDocument, 'keydown', function (event) {\n      if (event.which === 27) {\n        _this._handleKeyPress(event);\n      }\n    }));\n\n    _this.manage(on(_this.element.ownerDocument, 'keypress', function (event) {\n      if (event.which !== 27) {\n        _this._handleKeyPress(event);\n      }\n    }));\n\n    _this.manage(on(_this.element, 'mousedown', function () {\n      _this.wasOpenBeforeClick = element.classList.contains(_this.options.classShown);\n    }));\n\n    return _this;\n  }\n  /**\n   * Changes the shown/hidden state.\n   * @param {string} state The new state.\n   * @param {Object} detail The detail of the event trigging this action.\n   * @param {Function} callback Callback called when change in state completes.\n   */\n\n\n  _createClass(OverflowMenu, [{\n    key: \"changeState\",\n    value: function changeState(state, detail, callback) {\n      if (state === 'hidden') {\n        this.element.setAttribute('aria-expanded', 'false');\n      } else {\n        this.element.setAttribute('aria-expanded', 'true');\n      }\n\n      if (!this.optionMenu) {\n        var optionMenu = this.element.querySelector(this.options.selectorOptionMenu);\n\n        if (!optionMenu) {\n          throw new Error('Cannot find the target menu.');\n        } // Lazily create a component instance for menu\n\n\n        this.optionMenu = FloatingMenu.create(optionMenu, {\n          refNode: this.element,\n          classShown: this.options.classMenuShown,\n          classRefShown: this.options.classShown,\n          offset: this.options.objMenuOffset\n        });\n        this.children.push(this.optionMenu);\n      }\n\n      if (this.optionMenu.element.classList.contains(this.options.classMenuFlip)) {\n        this.optionMenu.options.offset = this.options.objMenuOffsetFlip;\n      } // Delegates the action of changing state to the menu.\n      // (And thus the before/after shown/hidden events are fired from the menu)\n\n\n      this.optionMenu.changeState(state, Object.assign(detail, {\n        delegatorNode: this.element\n      }), callback);\n    }\n    /**\n     * Handles click on document.\n     * @param {Event} event The triggering event.\n     * @private\n     */\n\n  }, {\n    key: \"_handleDocumentClick\",\n    value: function _handleDocumentClick(event) {\n      var element = this.element,\n          optionMenu = this.optionMenu,\n          wasOpenBeforeClick = this.wasOpenBeforeClick;\n      var isOfSelf = element.contains(event.target);\n      var isOfMenu = optionMenu && optionMenu.element.contains(event.target);\n      var shouldBeOpen = isOfSelf && !wasOpenBeforeClick;\n      var state = shouldBeOpen ? 'shown' : 'hidden';\n\n      if (isOfSelf) {\n        if (element.tagName === 'A') {\n          event.preventDefault();\n        }\n\n        event.delegateTarget = element; // eslint-disable-line no-param-reassign\n      }\n\n      this.changeState(state, getLaunchingDetails(event), function () {\n        if (state === 'hidden' && isOfMenu) {\n          element.focus();\n        }\n      });\n    }\n    /**\n     * Handles key press on document.\n     * @param {Event} event The triggering event.\n     * @private\n     */\n\n  }, {\n    key: \"_handleKeyPress\",\n    value: function _handleKeyPress(event) {\n      var key = event.which;\n      var element = this.element,\n          optionMenu = this.optionMenu,\n          options = this.options;\n      var isOfMenu = optionMenu && optionMenu.element.contains(event.target);\n\n      if (key === 27) {\n        this.changeState('hidden', getLaunchingDetails(event), function () {\n          if (isOfMenu) {\n            element.focus();\n          }\n        });\n      }\n\n      if (key === 13 || key === 32) {\n        var isOfSelf = element.contains(event.target);\n        var shouldBeOpen = isOfSelf && !element.classList.contains(options.classShown);\n        var state = shouldBeOpen ? 'shown' : 'hidden';\n\n        if (isOfSelf) {\n          // 32 is to prevent screen from jumping when menu is opened with spacebar\n          if (element.tagName === 'A' || key === 32) {\n            event.preventDefault();\n          }\n\n          event.delegateTarget = element; // eslint-disable-line no-param-reassign\n        }\n\n        this.changeState(state, getLaunchingDetails(event), function () {\n          if (state === 'hidden' && isOfMenu) {\n            element.focus();\n          }\n        });\n      }\n    }\n  }], [{\n    key: \"options\",\n    get: function get() {\n      var prefix = settings.prefix;\n      return {\n        selectorInit: '[data-overflow-menu]',\n        selectorOptionMenu: \".\".concat(prefix, \"--overflow-menu-options\"),\n        classShown: \"\".concat(prefix, \"--overflow-menu--open\"),\n        classMenuShown: \"\".concat(prefix, \"--overflow-menu-options--open\"),\n        classMenuFlip: \"\".concat(prefix, \"--overflow-menu--flip\"),\n        objMenuOffset: getMenuOffset,\n        objMenuOffsetFlip: getMenuOffset\n      };\n    }\n  }]);\n\n  return OverflowMenu;\n}(mixin(createComponent, initComponentBySearch, eventedShowHideState, handles));\n\nOverflowMenu.components = new WeakMap();\nexport default OverflowMenu;","map":{"version":3,"sources":["/Users/tatianamoreira/Documents/testTech/react/carbon-design-react-test/src/components/overflow-menu/overflow-menu.js"],"names":["settings","mixin","createComponent","initComponentBySearch","eventedShowHideState","handles","FloatingMenu","DIRECTION_TOP","DIRECTION_BOTTOM","getLaunchingDetails","on","triggerButtonPositionProps","triggerButtonPositionFactors","getMenuOffset","menuBody","direction","triggerButtonPositionProp","triggerButtonPositionFactor","console","warn","menuWidth","offsetWidth","arrowStyle","ownerDocument","defaultView","getComputedStyle","values","reduce","o","name","Number","exec","getPropertyValue","Object","keys","every","isNaN","left","width","height","borderTopWidth","Math","sqrt","top","undefined","OverflowMenu","element","options","manage","event","_handleDocumentClick","wasOpenBeforeClick","which","_handleKeyPress","classList","contains","classShown","state","detail","callback","setAttribute","optionMenu","querySelector","selectorOptionMenu","Error","create","refNode","classMenuShown","classRefShown","offset","objMenuOffset","children","push","classMenuFlip","objMenuOffsetFlip","changeState","assign","delegatorNode","isOfSelf","target","isOfMenu","shouldBeOpen","tagName","preventDefault","delegateTarget","focus","key","prefix","selectorInit","components","WeakMap"],"mappings":"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","sourcesContent":["import settings from '../../globals/js/settings';\nimport mixin from '../../globals/js/misc/mixin';\nimport createComponent from '../../globals/js/mixins/create-component';\nimport initComponentBySearch from '../../globals/js/mixins/init-component-by-search';\nimport eventedShowHideState from '../../globals/js/mixins/evented-show-hide-state';\nimport handles from '../../globals/js/mixins/handles';\nimport FloatingMenu, { DIRECTION_TOP, DIRECTION_BOTTOM } from '../floating-menu/floating-menu';\nimport getLaunchingDetails from '../../globals/js/misc/get-launching-details';\nimport on from '../../globals/js/misc/on';\n\n/**\n * The CSS property names of the arrow keyed by the floating menu direction.\n * @type {Object<string, string>}\n */\nconst triggerButtonPositionProps = {\n  [DIRECTION_TOP]: 'bottom',\n  [DIRECTION_BOTTOM]: 'top',\n};\n\n/**\n * Determines how the position of arrow should affect the floating menu position.\n * @type {Object<string, number>}\n */\nconst triggerButtonPositionFactors = {\n  [DIRECTION_TOP]: -2,\n  [DIRECTION_BOTTOM]: -1,\n};\n\n/**\n * @param {Element} menuBody The menu body with the menu arrow.\n * @param {string} direction The floating menu direction.\n * @returns {FloatingMenu~offset} The adjustment of the floating menu position, upon the position of the menu arrow.\n * @private\n */\nexport const getMenuOffset = (menuBody, direction) => {\n  const triggerButtonPositionProp = triggerButtonPositionProps[direction];\n  const triggerButtonPositionFactor = triggerButtonPositionFactors[direction];\n  if (!triggerButtonPositionProp || !triggerButtonPositionFactor) {\n    console.warn('Wrong floating menu direction:', direction); // eslint-disable-line no-console\n  }\n  const menuWidth = menuBody.offsetWidth;\n  const arrowStyle = menuBody.ownerDocument.defaultView.getComputedStyle(menuBody, ':before');\n  const values = [triggerButtonPositionProp, 'left', 'width', 'height', 'border-top-width'].reduce(\n    (o, name) => ({\n      ...o,\n      [name]: Number((/^([\\d-.]+)px$/.exec(arrowStyle.getPropertyValue(name)) || [])[1]),\n    }),\n    {}\n  );\n  if (Object.keys(values).every(name => !isNaN(values[name]))) {\n    const { left, width, height, 'border-top-width': borderTopWidth } = values;\n    return {\n      left: menuWidth / 2 - (left + Math.sqrt(width ** 2 + height ** 2) / 2),\n      top: Math.sqrt(borderTopWidth ** 2 * 2) + triggerButtonPositionFactor * values[triggerButtonPositionProp],\n    };\n  }\n  return undefined;\n};\n\nclass OverflowMenu extends mixin(createComponent, initComponentBySearch, eventedShowHideState, handles) {\n  /**\n   * Overflow menu.\n   * @extends CreateComponent\n   * @extends InitComponentBySearch\n   * @extends Handles\n   * @param {HTMLElement} element The element working as a modal dialog.\n   * @param {Object} [options] The component options.\n   * @param {string} [options.selectorOptionMenu] The CSS selector to find the menu.\n   * @param {string} [options.classShown] The CSS class for the shown state, for the trigger UI.\n   * @param {string} [options.classMenuShown] The CSS class for the shown state, for the menu.\n   * @param {string} [options.classMenuFlip] The CSS class for the flipped state of the menu.\n   * @param {Object} [options.objMenuOffset] The offset locating the menu for the non-flipped state.\n   * @param {Object} [options.objMenuOffsetFlip] The offset locating the menu for the flipped state.\n   */\n  constructor(element, options) {\n    super(element, options);\n    this.manage(\n      on(this.element.ownerDocument, 'click', event => {\n        this._handleDocumentClick(event);\n        this.wasOpenBeforeClick = undefined;\n      })\n    );\n    this.manage(\n      on(this.element.ownerDocument, 'keydown', event => {\n        if (event.which === 27) {\n          this._handleKeyPress(event);\n        }\n      })\n    );\n    this.manage(\n      on(this.element.ownerDocument, 'keypress', event => {\n        if (event.which !== 27) {\n          this._handleKeyPress(event);\n        }\n      })\n    );\n    this.manage(\n      on(this.element, 'mousedown', () => {\n        this.wasOpenBeforeClick = element.classList.contains(this.options.classShown);\n      })\n    );\n  }\n\n  /**\n   * Changes the shown/hidden state.\n   * @param {string} state The new state.\n   * @param {Object} detail The detail of the event trigging this action.\n   * @param {Function} callback Callback called when change in state completes.\n   */\n  changeState(state, detail, callback) {\n    if (state === 'hidden') {\n      this.element.setAttribute('aria-expanded', 'false');\n    } else {\n      this.element.setAttribute('aria-expanded', 'true');\n    }\n\n    if (!this.optionMenu) {\n      const optionMenu = this.element.querySelector(this.options.selectorOptionMenu);\n      if (!optionMenu) {\n        throw new Error('Cannot find the target menu.');\n      }\n\n      // Lazily create a component instance for menu\n      this.optionMenu = FloatingMenu.create(optionMenu, {\n        refNode: this.element,\n        classShown: this.options.classMenuShown,\n        classRefShown: this.options.classShown,\n        offset: this.options.objMenuOffset,\n      });\n      this.children.push(this.optionMenu);\n    }\n    if (this.optionMenu.element.classList.contains(this.options.classMenuFlip)) {\n      this.optionMenu.options.offset = this.options.objMenuOffsetFlip;\n    }\n\n    // Delegates the action of changing state to the menu.\n    // (And thus the before/after shown/hidden events are fired from the menu)\n    this.optionMenu.changeState(state, Object.assign(detail, { delegatorNode: this.element }), callback);\n  }\n\n  /**\n   * Handles click on document.\n   * @param {Event} event The triggering event.\n   * @private\n   */\n  _handleDocumentClick(event) {\n    const { element, optionMenu, wasOpenBeforeClick } = this;\n    const isOfSelf = element.contains(event.target);\n    const isOfMenu = optionMenu && optionMenu.element.contains(event.target);\n    const shouldBeOpen = isOfSelf && !wasOpenBeforeClick;\n    const state = shouldBeOpen ? 'shown' : 'hidden';\n\n    if (isOfSelf) {\n      if (element.tagName === 'A') {\n        event.preventDefault();\n      }\n      event.delegateTarget = element; // eslint-disable-line no-param-reassign\n    }\n\n    this.changeState(state, getLaunchingDetails(event), () => {\n      if (state === 'hidden' && isOfMenu) {\n        element.focus();\n      }\n    });\n  }\n\n  /**\n   * Handles key press on document.\n   * @param {Event} event The triggering event.\n   * @private\n   */\n  _handleKeyPress(event) {\n    const key = event.which;\n    const { element, optionMenu, options } = this;\n    const isOfMenu = optionMenu && optionMenu.element.contains(event.target);\n\n    if (key === 27) {\n      this.changeState('hidden', getLaunchingDetails(event), () => {\n        if (isOfMenu) {\n          element.focus();\n        }\n      });\n    }\n\n    if (key === 13 || key === 32) {\n      const isOfSelf = element.contains(event.target);\n      const shouldBeOpen = isOfSelf && !element.classList.contains(options.classShown);\n      const state = shouldBeOpen ? 'shown' : 'hidden';\n\n      if (isOfSelf) {\n        // 32 is to prevent screen from jumping when menu is opened with spacebar\n        if (element.tagName === 'A' || key === 32) {\n          event.preventDefault();\n        }\n        event.delegateTarget = element; // eslint-disable-line no-param-reassign\n      }\n\n      this.changeState(state, getLaunchingDetails(event), () => {\n        if (state === 'hidden' && isOfMenu) {\n          element.focus();\n        }\n      });\n    }\n  }\n\n  static components = new WeakMap();\n\n  static get options() {\n    const { prefix } = settings;\n    return {\n      selectorInit: '[data-overflow-menu]',\n      selectorOptionMenu: `.${prefix}--overflow-menu-options`,\n      classShown: `${prefix}--overflow-menu--open`,\n      classMenuShown: `${prefix}--overflow-menu-options--open`,\n      classMenuFlip: `${prefix}--overflow-menu--flip`,\n      objMenuOffset: getMenuOffset,\n      objMenuOffsetFlip: getMenuOffset,\n    };\n  }\n}\n\nexport default OverflowMenu;\n"]},"metadata":{},"sourceType":"module"}